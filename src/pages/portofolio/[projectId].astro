---
import { projectPageContentFetcher, projectsIDFetcher } from "@/api";
import Spacer from "@/components/Spacer.astro";
import Layout from "@/layouts/Layout.astro";
import { dateConverter, months } from "@/utils";

export async function getStaticPaths() {
  return (await projectsIDFetcher()).allProjects.map(({ id }) => {
    return {
      params: { projectId: id },
    };
  });
}

const { projectId } = Astro.params;
const {
  projectName,
  gradientStartColor,
  gradientEndColor,
  projectStartDate,
  projectEndDate,
  shortDescription,
} = await projectPageContentFetcher(projectId ?? "");

const { month: startMonth, year: startYear } = dateConverter(projectStartDate);
const { month: endMonth, year: endYear } = projectEndDate
  ? dateConverter(projectEndDate)
  : { month: 0, year: 0 };
---

<Layout title="" pageDescription="" activeNavigationOption={""}>
  <div class="w-full px-horizontalPaddingMobile lg:px-horizontalPaddingDesktop">
    <main
      class="flex flex-col items-center justify-start w-full max-w-5xl mx-auto"
    >
      <header
        class="flex flex-col items-start justify-start text-silver-100 gap-2 w-full border-4 border-silver-100 rounded-lg p-4 shadow-lg"
        style={`
          border-color: ${gradientStartColor};
          --tw-shadow-color: ${gradientEndColor}7F;
          --tw-shadow: var(--tw-shadow-colored);
      `}
      >
        <div class="flex flex-col items-start justify-start w-full gap-1">
          <h1 class="text-3xl lg:text-4xl text-left font-black">
            {projectName}
          </h1>
          <p class="text-xl text-left text-black-100">
            {shortDescription}
          </p>
        </div>
        <p class="text-base font-medium text-left">
          {months[startMonth - 1]}
          {startYear}
          {projectEndDate ? `${months[endMonth - 1]} ${endYear}` : null}
        </p>
      </header>
    </main>
  </div>
  <Spacer />
</Layout>
